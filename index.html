<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DD Gaming Zone Tracker</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    body {
      background: url('https://assets-v2.lottiefiles.com/a/92d96e2c-117a-11ee-b889-930318cb76ca/bfF68kVD7b.gif') no-repeat center center fixed;
      background-size: cover;
      color: white;
    }
    .session-card {
      transition: transform 0.3s ease, background-color 0.3s ease;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.6);
    }
    .session-card:hover {
      transform: scale(1.03);
    }
    .critical {
      background-color: #ff4c4c !important;
    }
    .card-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .modal-dark .modal-content {
      background-color: #2c2c2c;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="text-center mb-4">ðŸŽ® DD Gaming Zone Tracker</h1>
    <form id="trackerForm" class="row g-3">
      <div class="col-md-4">
        <input type="text" id="name" class="form-control" placeholder="Name" required />
      </div>
      <div class="col-md-4">
        <input type="text" id="mobile" class="form-control" placeholder="Mobile Number" required />
      </div>
      <div class="col-md-4">
        <input type="text" id="address" class="form-control" placeholder="Address" />
      </div>
      <div class="col-md-3">
        <select id="system" class="form-select" required>
          <option value="">Select System</option>
          <option value="PC-1">PC-1</option>
          <option value="PC-2">PC-2</option>
          <option value="PC-3">PC-3</option>
          <option value="PC-4">PC-4</option>
          <option value="PC-5">PC-5</option>
          <option value="PC-6">PC-6</option>
          <option value="PS-1">PlayStation-1</option>
          <option value="PS-2">PlayStation-2</option>
        </select>
      </div>
      <div class="col-md-3">
        <input type="number" id="allocatedTime" class="form-control" placeholder="Time in Minutes" required />
      </div>
      <div class="col-md-2">
        <input type="checkbox" id="isChild" /> <label for="isChild">Below 12?</label>
      </div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-success w-100">Start Session</button>
      </div>
    </form>

    <hr class="my-4">
    <div class="card-container" id="sessionContainer"></div>
  </div>

  <!-- Approval Modal -->
  <div class="modal fade" id="approvalModal" tabindex="-1" aria-labelledby="approvalModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content modal-dark">
        <div class="modal-header">
          <h5 class="modal-title" id="approvalModalLabel">Record Parent Approval</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <textarea class="form-control" id="approvalNotes" placeholder="Approval notes..." rows="3"></textarea>
          <input type="number" class="form-control mt-2" id="extendMinutes" placeholder="Extend time in minutes" />
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-success" id="approveBtn">Approve</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    let sessions = [];
    const container = document.getElementById('sessionContainer');

    document.getElementById('trackerForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const name = document.getElementById('name').value;
      const mobile = document.getElementById('mobile').value;
      const address = document.getElementById('address').value;
      const system = document.getElementById('system').value;
      const allocatedTime = parseInt(document.getElementById('allocatedTime').value);
      const isChild = document.getElementById('isChild').checked;

      const session = {
        id: Date.now(),
        name, mobile, address, system,
        allocatedTime,
        startTime: new Date(),
        isChild,
        approved: false
      };
      sessions.push(session);
      renderSessions();
    });

    function renderSessions() {
      container.innerHTML = '';
      sessions.forEach((session) => {
        const elapsed = (new Date() - new Date(session.startTime)) / 60000;
        const remaining = session.allocatedTime - elapsed;
        const percentLeft = (remaining / session.allocatedTime) * 100;

        const div = document.createElement('div');
        div.className = `p-3 session-card bg-dark text-white ${percentLeft <= 10 ? 'critical' : ''}`;
        div.innerHTML = `
          <h5>${session.name} (${session.system})</h5>
          <p>Time Left: ${Math.max(0, Math.floor(remaining))} min</p>
          <p>${session.isChild ? 'ðŸ‘¶ Child' : 'ðŸ§‘ Adult'} | â‚¹${session.system.startsWith('PC') ? 100 : 150}</p>
          <button class="btn btn-warning btn-sm" onclick="openApproval(${session.id})">Record Approval</button>
          <button class="btn btn-danger btn-sm" onclick="closeSession(${session.id})">Close</button>
        `;
        container.appendChild(div);

        if (remaining <= 0 && !session.alerted) {
          alert(`â° Time's up for ${session.name} on ${session.system}`);
          session.alerted = true;
        }
      });
    }

    function openApproval(id) {
      const session = sessions.find(s => s.id === id);
      if (!session) return;

      const modal = new bootstrap.Modal(document.getElementById('approvalModal'));
      modal.show();
      document.getElementById('approveBtn').onclick = function () {
        const extend = parseInt(document.getElementById('extendMinutes').value);
        if (!isNaN(extend)) {
          session.allocatedTime += extend;
        }
        session.approved = true;
        modal.hide();
        renderSessions();
      };
    }

    function closeSession(id) {
      sessions = sessions.filter(s => s.id !== id);
      renderSessions();
    }

    setInterval(renderSessions, 10000);
  </script>
</body>
</html>
